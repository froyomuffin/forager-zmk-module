#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>
#include <dt-bindings/zmk/outputs.h>

#define Base        0
#define LMOD        1
#define RMOD        2
#define CONFIG      3
#define GAME        4
#define GAME_LMOD   5
#define GAME_RMOD   6

#define BA          0
#define LM          1
#define RM          2
#define CO          3
#define GA          4
#define GL          5
#define GR          6


&kscan0 {
    debounce-press-ms = <5>;
    debounce-release-ms = <3>;
};

&mt {
    quick-tap-ms = <100>;
    global-quick-tap;
    flavor = "tap-preferred";
    tapping-term-ms = <170>;
};

&lt {
    tapping-term-ms = <240>;
    flavor = "balanced";
    quick-tap-ms = <150>;
};

/ {
    behaviors {
        hm: homerow_mods {
            compatible = "zmk,behavior-hold-tap";
            label = "HOMEROW_MODS";
            #binding-cells = <2>;
            flavor = "tap-preferred";
            tapping-term-ms = <200>;
            quick-tap-ms = <125>;
            global-quick-tap;
            bindings = <&kp>, <&kp>;
        };
        gresc: grave_escape {
            compatible = "zmk,behavior-mod-morph";
            #binding-cells = <0>;
            bindings = <&kp ESC>, <&kp GRAVE>;
            mods = <(MOD_LCTL|MOD_LGUI|MOD_RCTL|MOD_RGUI)>;
        };
        l_cgui: left_ctrl_gui {
            compatible = "zmk,behavior-tap-dance";
            #binding-cells = <0>;
            tapping-term-ms = <200>;
            bindings = <&kp LCTRL>, <&kp LGUI>;
        };
    };

    keymap {
        compatible = "zmk,keymap";

        /* REF { */
        /*     display-name = "REF"; */
        /*     bindings = < */
        /*     &trans          &trans          &trans          &trans          &trans          &trans                                          &trans          &trans          &trans          &trans          &trans          &trans */
        /*     &trans          &trans          &trans          &trans          &trans          &trans                                          &trans          &trans          &trans          &trans          &trans          &trans */
        /*     &trans          &trans          &trans          &trans          &trans          &trans                                          &trans          &trans          &trans          &trans          &trans          &trans */
        /*                                                                                     &trans          &trans          &trans          &trans */
        /*     >; */
        /* }; */

        Base {
            display-name = "Base";
            bindings = <
            &kp ESC         &kp Q           &kp W           &kp E           &kp R           &kp T                                           &kp Y           &kp U           &kp I           &kp O           &kp P           &kp BSLH
            &kp TAB         &kp A           &kp S           &kp D           &kp F           &kp G                                           &kp H           &kp J           &kp K           &kp L           &kp SEMI        &kp SQT
            &l_cgui         &kp Z           &kp X           &kp C           &kp V           &kp B                                           &kp N           &kp M           &kp COMMA       &kp DOT         &kp FSLH        &kp BSPC
                                                                                            &mo LM          &mt LSHFT SPACE &mt RSHFT RET   &mo RM
            >;
        };

        LMOD {
            display-name = "LMOD";
            bindings = <
            &none           &none           &none           &kp UP          &none           &kp LBRC                                        &kp RBRC        &kp N7          &kp N8          &kp N9          &kp N0          &none
            &none           &none           &kp LEFT        &kp DOWN        &kp RIGHT       &kp LBKT                                        &kp RBKT        &kp N4          &kp N5          &kp N6          &none           &none
            &none           &none           &none           &none           &none           &kp LPAR                                        &kp RPAR        &kp N1          &kp N2          &kp N3          &none           &none
                                                                                            &trans          &none           &none           &mo CO
            >;
        };

        RMOD {
            display-name = "RMOD";
            bindings = <
            &none           &none           &none           &kp UP          &none           &kp LBRC                                        &kp RBRC        &kp N7          &kp N8          &kp N9          &kp N0          &none
            &none           &none           &kp LEFT        &kp DOWN        &kp RIGHT       &kp LBKT                                        &kp RBKT        &kp N4          &kp N5          &kp N6          &none           &none
            &none           &none           &none           &none           &none           &kp LPAR                                        &kp RPAR        &kp N1          &kp N2          &kp N3          &none           &none
                                                                                            &mo CO          &none           &none           &trans
            >;
        };

        CONFIG {
            display-name = "CONFIG";
            bindings = <
            &none           &none           &none           &none           &none           &none                                           &none           &none           &none           &none           &none           &none
            &none           &none           &none           &none           &none           &none                                           &none           &none           &none           &none           &none           &none
            &sys_reset      &none           &none           &none           &none           &none                                           &none           &none           &none           &none           &none           &bootloader
                                                                                            &none           &none           &none           &none
            >;
        };
    };
};
